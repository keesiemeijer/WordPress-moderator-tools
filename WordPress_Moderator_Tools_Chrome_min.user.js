// ==UserScript==
// @name        WordPress Moderator Tools
// @namespace   WordPress_moderator_tools
// @description Adds keyboard shortcut navigation (and more) for WordPress forum moderators.
// @include     *://*wordpress.org/support/bb-admin/posts.php*
// @include     *://*wordpress.org/support/bb-admin/topics.php*
// @include     *://*wordpress.org/support/profile/*
// @include     *://*wordpress.org/support/forum/*
// @include     *://*wordpress.org/support/topic/*
// @include     *://*wordpress.org/support/edit.php?id=*
// @include     *://*wordpress.org/support/view/*
// @include     *://*wordpress.org/tags/modlook
// @include     *://*wordpress.org/support/
// @include     *://*.forums.wordpress.org/bb-admin/posts.php*
// @include     *://*.forums.wordpress.org/bb-admin/topics.php*
// @include     *://*.forums.wordpress.org/profile/*
// @include     *://*.forums.wordpress.org/forum/*
// @include     *://*.forums.wordpress.org/topic/*
// @include     *://*.forums.wordpress.org/edit.php?id=*
// @include     *://*.forums.wordpress.org/view/*
// @include     *://*.forums.wordpress.org/
// @version     5.0.5
// @downloadURL https://github.com/keesiemeijer/WordPress-moderator-tools/raw/master/WordPress_Moderator_Tools_Chrome_min.user.js
// @updateURL https://github.com/keesiemeijer/WordPress-moderator-tools/raw/master/WordPress_Moderator_Tools_Chrome_min.user.js
// @grant       none
// ==/UserScript==

function moderator_tools_with_jquery(b){var a=document.createElement("script");a.type="text/javascript";a.textContent="("+b.toString()+")(jQuery)";document.body.appendChild(a)}moderator_tools_with_jquery(function(O){var ad="hide";var g="#e3cebd";var N="#moderator_tools_menu{position:fixed;top:10px;left:65px;background:white;border:3px solid #333333; color:#333333; padding: 0 3em 0 10px;}#moderator_tools_menu a{text-decoration:none;border:none;}#moderator_tools_menu a:hover{color:#d54e21;}#wordpress-org #moderator_tools_menu{font-size:13px}#wordpress-org #moderator_tools_menu .wpmt_close_menu span{display:none; }.wpmt_stats{padding-bottom:1em;}.wpmt_stats span{display:inline-block;margin:5px 0;}.wpmt_shortcuts_help{margin-left:5px;} .wpmt_shortcut{background-color:#cae8f7;padding:1px 3px;display:inline-block;margin-bottom:4px;font-weight:bold}.wpmt_shortcuts_title{display:block;font-weight:bold;margin:1em 0}#wordpress-org .wpmt_shortcuts_title{display:inline}.wpmt_shortcuts_top{margin-bottom:1em}.wpmt_close_menu{position: absolute; right: 0; top: 5px;padding:0;margin:4px 1em 0 0; }.wpmt_close_menu a{font-size:1.8em;border:0;}.wpmt_is_admin .wpmt_close_menu a{font-size:1.5em;}.wpmt_menu_state{margin-right:40px}.wpmt_profile_edit{display:block;margin-top:5px}.wpmt_modlook{background-color:#efeef5;margin-left:.5em;padding:1px 2px;}.wpmt_ip-warning{color:red;display:block;} .reviewer .wpmt_ip-warning{display:inline-block;margin-right:1em;}.wpmt_screen_reader_text{clip: rect(1px, 1px, 1px, 1px);position: absolute !important;height: 1px;width: 1px;overflow: hidden;}.wpmt_error{color:red;}",e="wpmt_current",aj="https://wordpress.org/support/bb-admin",b="https://"+window.location.hostname,H='<span class="wpmt_shortcuts_title">Shortcuts available for this page:</span>',c=O('<div id="moderator_tools_menu"></div>'),z=O('<span class="wpmt_close_menu"><a href="#" >&times;</a></span>'),L=O('<span class="wpmt_menu_state"></span>'),Y=O('<p class="wpmt_shortcuts_top"></p>'),i={},G={},I=false,a=false,Z=false,R=true,f,S,s,D,ai;var h={ANT:new RegExp('id="elf_not_trusted".+?checked="checked"',"gi"),EditPost:new RegExp(".+?/support/edit.php.+?","gi"),username:new RegExp('id="userlogin">(.+?)<',"gi")};var K={a:"%a% - <span class='wpmt_select'>select</span>/deselect all posts",d:"%d% - loop through Bulk Actions dropdown options",e1:"%e% - edit the user profile from the current post in a new tab.",e2:"%e% - refresh this profile page",e3:"%e% - open the edit profile page in a new tab",e4:"%e% - open the current post's user profile page in a new tab",h:"%h% - show/hide shortcuts",i:"%i% - edit all user profiles from <span class='wpmt_select'>selected posts</span> in new tabs.",shift_i:"%shift i% to edit non bozo user profiles only",m:"%m% - show/hide menu",n:"%n% - go to User Activity",r:"%r% - open the user's bb-admin posts page in a new tab",s:"%s% - <span class='wpmt_select'>select</span>/deselect current post",v:"%v% - view current post in a new tab",w:"%w% - remove website url (or add it back)",x:'%x% - select/deselect "Akismet Never Trust" checkbox',z:'%z% - select/deselect "This user is a bozo" checkbox',shift_b:"%shift b% - block the current user",z_x:"%z% - go to the next normal profile post | %x% - go to the previous normal profile post",z_x1:"%z% - go to the next user with a duplicate IP | %x% - go to the previous user with a duplicate IP",shift_z_x:"%shift z% - go to the next bozo or blocked profile post | %shift x% - go to the previous bozo or blocked profile post",t_b:"%t% - go to the top of this page  | %b% - go to the bottom of this page",n_p:"%n% - go to the next post | %p% - go to the previous post",click_author:"%mouse click% - Click in the Author column to <span class='wpmt_select'>select</span>/deselect a post (also sets the post to current)",click_post:"%mouse click% - Click anywhere in a post to set it to current, for navigation with the shortcuts %n% and %p% (see above)"};function ab(){if(v(O("#moderator_tools_menu"))||v(O("#moderator_tools_ed_uncap"))){return}var ak=true;if(v(O("#posts-list"))){a=true;Z=true;T("posts")}if(v(O("#topics-list"))){a=true;Z=true;T("topics")}if(!a){var an=O(".mod-login");if(v(an)){Z=true;var al=an.parents(".login").find("small > a").first().attr("href");if(al.length){al.split(/[?#]/)[0];al=al.replace(/\/$/g,"");aj=al}O("head").append('<style type="text/css">#headline .login{text-align:right;}</style>');an.append(' | <a href="'+aj+'/posts.php?forum_id=0&post_status=2">Spam Queue</a> | <a href="'+b+'/tags/modlook">Modlook</a>');if(v(O("#profile-form"))){P()}if(v(O(".edit-form"))){j();ac();ak=false}var am=O(".forumlist");if(v(am)){if(!am.hasClass("reviews")){ae(".widefat")}}if(v(O(".all-reviews"))){m();ak=false}}if(v(O("#user-replies"))||v(O("#user-threads"))){p()}if(v(O("#thread"))){y();ak=false}}else{c.addClass("wpmt_is_admin")}if(ak){ah();M();u()}E();x()}function T(al){var ao=(al==="topics")?"topic":"post";G={bulk_actions:"",topics:al==="topics"?true:false,column:".check-column > input",author:O("td.author"),toggle:O('<a href="#">shortcuts</a>'),help:O(' <span class="wpmt_shortcuts_help">(h) </span>'),stats:O('<span class="wpmt_stats"></span>')};G.bulk_actions_checkbox=O("thead tr "+G.column+",tfoot tr "+G.column);var ak="table.widefat tr.wpmt_current td{border:solid #9f9f9f;border-width:2px 0}table.widefat tr.wpmt_current td.check-column{border-left:2px solid #9f9f9f}table#posts-list tr.wpmt_current td.date,table#topics-list tr.wpmt_current td.freshness{border-right:2px solid #9f9f9f}{border-right:2px solid #9f9f9f}.wpmt_bozo_profile{display:block;margin-top:10px;color:white;text-align:center;background:red}.wpmt_profile_type{padding:4px 6px;border:1px solid red}.wpmt_profile_type.wpmt_green{border:1px solid green}.wpmt_selected,.wpmt_select{background-color: "+g+";}.wpmt_profile_type.wpmt_selected{padding: 5px 7px;border:none;}";ak+='.mod-tools-ips-btn, .mod-tools-ips-wrapper{font-family: "Lucida Grande", Verdana, Arial, "Bitstream Vera Sans", sans-serif;} .mod-tools-ips-btn {border-radius:10px;padding:4px 9px 5px;background:url(images/white-grad.png) repeat-x #f2f2f2;border:1px solid #bbb;color:#464646;cursor:pointer;line-height:1.1em;font-size:.85em; margin: 1.2em 0 0 5em}.mod-tools-ips-wrapper{font-size: .85em; margin: 1em 0;} .mod-tools-ips-heading {font-weight: 700; margin-bottom: .8em} .mod-tools-results-list {padding-left: 5px; border-left: 2px solid gold;} .mod-tools-ips-button-pressed {border-color: gold;}';O("head").append('<style type="text/css">'+N+ak+"</style>");var an=k([K.m,K.t_b,K.n_p,K.h,K.d,K.a,K.s,K.v,K.e1,K.i]);if(!G.topics){an=an.replace(/<br\/>$/g,"");an+=" | "+k([K.shift_i,K.z_x,K.shift_z_x])}an+=k([K.click_author,K.click_post]);an=(G.topics)?an.split("post").join(ao):an;G.shortcuts=O('<p style="display: none;">'+H+an+"</p>");c.append(G.stats,G.help,G.toggle,z,G.shortcuts);O("body").append(c);O("#bbUserInfo > p").prepend(L);d();s="tr."+e;D="tr:first";ai=O("#"+al+"-list tbody tr");f=O("#bbHead");S=ai.last();ag();n();var am=O(".post");q(am);if(t("post_author").length){W()}}function P(){var al=O("input#user_url");G={website:al,site_url:al.val(),bozo:O("input#is_bozo"),askimet:O("input#elf_not_trusted"),trusted:O("input#elf_trusted"),location:O("input#from"),occupation:O("input#occ"),interest:O("input#interest"),user_type:O("select#admininfo_role"),};O("head").append('<style type="text/css">'+N+"</style>");var ak=K.n_p.split("post").join("section");var am=k([K.m,K.t_b,ak,K.e2,K.r,K.w,K.z,K.x,K.shift_b]);Y.append(H,z);am="<p>"+am+"</p>";c.append(Y,am);O("body").append(c);L.insertBefore(O("#profile-form")).wrap("<p></p>");d();s="#profile-form h3."+e;D="h3.wpmt_section:first";ai=O("#profile-form h3");ai.addClass("wpmt_section");O("h3:contains('Mailing Lists')").removeClass("wpmt_section");O("h3:contains('Administration')").addClass("wpmt_admin_section");O("label[for='user_url']").append(C(" %(w)%"));O("label[for='is_bozo']").append(C(" %(z)%"));O("label[for='elf_not_trusted']").append(C(" %(x)%"));f=O("#wporg-header");S=O("#wporg-footer");X();w()}function p(){O("head").append('<style type="text/css">'+N+"</style>");var al=k([K.m,K.t_b,K.n]);if(Z){al+=k([K.e3,K.r])}Y.append(H,z);al="<p>"+al+"</p>";c.append(Y,al);O("body").append(c);var ak=O(".topicnav").first().find("p");ak.css("margin","0 0 .5em");L.insertAfter(ak).wrap("<p></p>");d();O.each(["#user-replies","#user-threads"],function(am,an){ae(an)});s="#useractivity."+e;D=0;ai=O("#useractivity");f=O("#wporg-header");S=O("#wporg-footer");if(Z){X();if(v(G.edit_href)){O.get(G.edit_href,function(an){var ao=O(an).find("#admininfo_role option:selected");var am=O("dl#userinfo");if(v(ao)&&v(am)){am.append(O('<dt>User Type</dt><dd><span class="wpmt">'+ao.text()+"</span></dd>"))}})}}}function y(){G={tags:O("#yourtaglist"),author:".threadauthor > p > strong",post_content:O("#post_content"),};var al=".wpmt_current .authortitle a, .reviewer-name {background-color: #efeef5;padding: 3px 6px;margin: 3px 0;display: inline-block;}.wpmt_ip-warning{color:red;}";O("head").append('<style type="text/css">'+N+al+"</style>");var ak=k([K.m,K.t_b,K.n_p]);if(Z){ak+=k([K.z_x1])}ak+=k([K.e4,K.click_post]);var ao="<p>"+ak+"</p>";Y.append(H,z);c.append(Y,ao);O("body").append(c);var an=O(".topicnav").first().find(".bbcrumb");an.css("margin","0 0 .5em");L.insertAfter(an).wrap("<p></p>");d();s="li."+e;D="li:first";ai=O(".postitem");f=O("#wporg-header");S=ai.last();if(Z&&(v(ai)>1)){aa()}U();M();u();F();if(v(G.post_content)){O(".threadauthor > p",ai).each(function(ap){O(this).find(".authortitle").after(' - <a href="#post_content" class="wpmt_ping_link">@</a>')})}J();if(ai.length===1){ai.first().trigger("click.wpmt")}if((O("#thread").length!==0)&&v(O(".mod-login"))){var am=O(".threadpost .post");q(am)}}function m(){ai=O(".review");if(v(ai)<1){return}G={author:".reviewer-name",target:O(".review-ratings .col-1")};var ak="<p>"+k([K.m,K.t_b,K.n_p,K.z_x1])+"</p>";Y.append(H,z);c.append(Y,ak);O("body").append(c);O(".all-reviews").prepend(L);L.wrap("<p></p>");d();s="div."+e;f=O("#wporg-header");S=O("#wporg-footer");aa();B();U();l();M();u();N+=".wpmt_current a.reviewer-name {background-color: #efeef5;padding: 3px 6px;margin: 3px 0;display: inline-block;}";O("head").append('<style type="text/css">'+N+"</style>")}function w(){O("html").bind("keydown.wpmt",function(ap){var al=o(ap);var ao;if(I!==false){return}if(i.hasOwnProperty(66)&&(al===2)){if(i.hasOwnProperty(16)){ap.which="";i={};al=0;var ak=confirm("You're about to block this user!\nThis will remove user fields: Website, Location, Occupation and Interests.\n\n 'Cancel' to stop, 'OK' to block this user.");if(ak==true){G.website.val("");G.location.val("");G.occupation.val("");G.interest.val("");G.user_type.val("blocked");G.bozo.removeAttr("checked");G.trusted.removeAttr("checked");if(!G.askimet.attr("checked")){G.askimet.click()}O("#profile-form").submit()}}}if(1!==al){return}if((87===ap.keyCode)&&(v(G.website)===1)){O(s).removeClass(e);ao=ai.first();ao.addClass(e);af(ao);if(G.site_url){if(""===G.website.val()){G.website.val(G.site_url)}else{G.website.val("")}clearTimeout(an);G.website.parents("tr").css("background-color","#FFFFCC");var an=setTimeout(function(){G.website.parents("tr").css("background-color","#FFFFFF")},300)}}if(ap.keyCode===90||ap.keyCode===88){var am=(ap.keyCode===90)?G.bozo:G.askimet;if(am){O(s).removeClass(e);ao=O("h3.wpmt_admin_section").addClass(e);if(v(ao)===1){af(O(ao));if(am.attr("checked")){am.removeAttr("checked")}else{am.click()}clearTimeout(aq);am.parents("tr").css("background-color","#FFFFCC");var aq=setTimeout(function(){am.parents("tr").css("background-color","#FFFFFF")},300)}}}})}function J(){ai.bind("click.wpmt",function(ak){if(ak.target.nodeName!=="A"){A();O(this).addClass(e)}});O(".wpmt_ping_link").bind("click.wpmt_ping",function(an){an.preventDefault();var al=O(this).parents(".threadauthor").find("strong").first().text();if(!v(G.post_content)||!al.length){return}var ak=G.post_content;al="@"+al+"\n";var am=O.trim(ak.val());al=am.length?"\n\n"+al:al;ak.val(am+al);ak[0].focus();ak.scrollTop(ak[0].scrollHeight)});O("html").bind("keydown.wpmt",function(an){if(I!==false){return}var al=o(an);var am=O(s);if(v(am)){var ak=O(am).find(".authortitle a");if(v(ak)){if((an.keyCode===69)&&(al=1)){Q(ak.attr("href"))}}}});O('[class^="delete:yourtaglist:"]').click(function(am){if(R){am.preventDefault();var al=O(this).closest("li"),ak=O(this).attr("href");O.ajax({url:ak,async:true,dataType:"html",success:function(an){al.fadeOut()}})}})}function n(){O("html").bind("keydown.wpmt",function(at){if(I!==false){return}var ar=o(at);var au,al;if((at.keyCode===83)&&(ar===1)){au=O(s);if(v(au)===1){af(au);var am=au.find(G.column);am.attr("checked",!am.attr("checked"));ag()}}if((at.keyCode===86)&&(ar===1)){au=O(s);if(v(au)){var ax=G.topics?au.find(".row-title > a:first"):au.find(".row-actions > a:first");if(v(ax)){if(G.topics){al=ax.attr("href")}else{al=(ax.text()==="View")?ax.attr("href"):0}if(al.length){Q(al)}}}}if((at.keyCode===68)&&(ar===1)){O(".bulk-form select[name=action] > option:selected").removeAttr("selected").next("option").attr("selected","selected")}if((at.keyCode===65)&&(ar===1)){G.bulk_actions=(G.bulk_actions_checkbox.attr("checked"))?"off":"on";r()}if((at.keyCode===72)&&(ar===1)){G.shortcuts.toggle();au=O(s);if(v(au)){af(au)}}if(i.hasOwnProperty(73)){var ap,aw=[],av=false;if(!G.topics&&(i.hasOwnProperty(16)&&ar===2)){av=true;ap=O(".wpmt_normal_post").find(".post_selected")}else{if(ar===1){av=true;ap=O(".post_selected")}}if(av&&v(ap)){ap.each(function(){al=O(this).children().first("a").attr("href");if(aw.indexOf(al)===-1){aw.push(al);Q(al+"/edit")}})}}if((at.keyCode===69)&&(ar===1)){au=O(s);if(v(au)===1){al=au.find(".wpmt_profile_edit > a").attr("href");if(al.length){Q(al)}}}if(!G.topics&&(ai.length>=1)){if(i.hasOwnProperty(90)||i.hasOwnProperty(88)){var ao=(i.hasOwnProperty(16)&&(ar===2))?"bozo":"normal";var ay=i.hasOwnProperty(90)?"z":"x",an=O(".wpmt_"+ao+"_post");if(v(an)){if(!v(O(s))){if(ay==="z"||((an.length===1)&&ay==="x")){au=an.first();au.addClass(e);af(au)}}else{if(an.length===1){var aq=an.first();A();aq.addClass(e);af(aq)}else{var ak;au=O(s);if(ay==="z"){ak=au.nextAll(".wpmt_"+ao+"_post:first")}if(ay==="x"){ak=au.prevAll(".wpmt_"+ao+"_post:first")}if(v(ak)){A();ak.addClass(e);af(ak)}}}}}}});if(R){O(".post-delete-link, .post-spam-link").click(function(am){am.preventDefault();var al=O(this).closest("tr"),ak=O(this).attr("href");O.ajax({url:ak,async:true,dataType:"html",success:function(an){al.fadeOut(300,function(){O(this).remove();I=false;ag()})}})})}G.bulk_actions_checkbox.bind("click.wpmt",function(){G.bulk_actions=(O(this).attr("checked"))?"on":"off";r()});ai.bind("click.wpmt",function(ak){if(ak.target.nodeName!=="A"){O("tbody tr").removeClass(e);O(this).addClass(e)}});O("tbody > tr > "+G.column).bind("click.wpmt",function(ak){ag()});G.author.bind("click.wpmt",function(ak){if(ak.target.nodeName!=="A"){ag(O(this).parent().attr("id"))}});G.toggle.bind("click.wpmt",function(ak){ak.preventDefault();G.shortcuts.toggle()});z.bind("click.wpmt",function(ak){ak.preventDefault();G.shortcuts.hide()})}function X(){var ak=O("#profile-menu");var ap;var ao;var am;if(v(ak)){ap=ak.find("a").filter(function(ar){var aq=O(this).attr("href");if(aq.length){aq=aq.split(/[?#]/)[0];aq=aq.replace(/\/$/g,"");aq=aq.substring(aq.lastIndexOf("/")+1);if("edit"===aq.toLowerCase()){return true}}return false})}else{return}if(v(ap)){ap.text("Edit (e)");am=ap.attr("href");var al=O("#userlogin");if(v(al)){ao=aj+"/posts.php?forum_id=0&post_author="+al.text();var an=O('<li><a href="'+ao+'">bb-admin (r)</a></li>');ap.parent().after(an)}}if(!(v(am)||v(ao))){return}G.edit_href=am;O("html").bind("keydown.wpmt",function(ar){var aq=o(ar);if((I!==false)||(aq!==1)){return}if((ar.keyCode===69)&&(am.length)){if(v(O("#profile-form"))){location.reload(true)}else{Q(am)}}if((ar.keyCode===82)&&(ao.length)){Q(ao)}})}function ah(){var ak;O("html").bind("keydown.wpmt",function(an){if(I!==false||(typeof(ai)==="undefined")){return}var am=o(an);if(!(an.keyCode===78||an.keyCode===80)||(am!==1)){return}var al=an.keyCode===78?"n":"p";if(!v(O(s))){if(al==="n"){ak=ai.first();af(ak);ak.addClass(e)}}else{ak=O(s);if(al==="n"){if(v(ak.nextAll(D))){ak.removeClass(e).nextAll(D).addClass(e);af(O(s))}else{af(O(s))}}if(al==="p"){if(v(ak.prevAll(D))){ak.removeClass(e).prevAll(D).addClass(e);af(O(s))}else{ak.removeClass(e);if(v(f)&&D){af(f)}}}}})}function U(){var ak;O("html").bind("keydown.wpmt",function(aq){if(I!==false||(typeof(ai)==="undefined")){return}var an=o(aq);var al=0;O.each({90:"z",88:"x",78:"n",80:"p"},function(at,au){if(aq.keyCode===parseInt(at)){al=au}});if(!(al&&(an===1))){return}var ar=v(O(s));if(!ar&&((al==="n")||(al==="p"))){ap=ai.first();af(ap);ap.addClass(e)}else{var ap=false,am=false,ao=false;ai.each(function(at){var av=false,au=false;if(!O(this).hasClass(e)){if(O(this).has(".wpmt_ip-warning").length){am=at}ao=at}if(O(this).hasClass(e)){ap=at;if(al==="x"&&(am!==false)){av=am}if(al==="p"&&(ao!==false)){av=ao}if(av!==false){ai.eq(ap).removeClass(e);ai.eq(av).addClass(e);af(ai.eq(av));return false}}if(((ap!==false)&&(ap!==at))||!ar){if((al==="z")&&O(this).has(".wpmt_ip-warning").length){au=at}if(al==="n"){au=at}if(au!==false){ai.eq(ap).removeClass(e);ai.eq(au).addClass(e);af(ai.eq(au));return false}}})}})}function M(){O("html").bind("keydown.wpmt",function(al){if(I!==false){return}var ak=o(al);if(v(f)&&(al.keyCode===84)&&(ak===1)){af(f);if(typeof(ai)!=="undefined"){A()}}if(v(S)&&(al.keyCode===66)&&(ak===1)){af(S);if(typeof(ai)!=="undefined"){A();ai.last().addClass(e)}}})}function u(){z.bind("click.wpmt",function(al){al.preventDefault();c.toggle();ad=(c.is(":visible"))?"show":"hide";d();var ak=O(s);if(v(ak)){af(ak)}});O("html").bind("keydown.wpmt",function(al){if(I!==false){return}var ak=o(al);if((al.keyCode===77)&&(ak===1)){z.trigger("click.wpmt")}})}function r(){G.author.each(function(){var ak=O(this).parent().find(G.column);if(G.bulk_actions==="on"){ak.attr("checked",true)}else{ak.attr("checked",false)}});ag();G.bulk_actions=false}function ag(ap){G.stats.empty();var ao=0;G.author.each(function(){var ay=O(this).parent().children(".check-column").css("background-color"),at=O.trim(O(this).children().first("a").text()),av=O(this).parent().find(G.column);O(this).css("background",ay);if(!v(O(this).children(".wpmt_profile_edit"))){var ar=O("img",O(this).children().first("a")),aq='<br/><span class="wpmt_profile_edit"><a href="'+O(this).children().first("a").attr("href")+'/edit">Edit Profile</a></span>';var au=(at.indexOf("(BOZO)")!==-1)?"BOZO":"";if(at.indexOf("(BLOCKED)")!==-1){au+=(au.length)?" - BLOCKED":"BLOCKED"}if(au.length){at=O.trim(at.replace("(BOZO)",""));at=O.trim(at.replace("(BLOCKED)",""));O(this).children().first("a").text(" "+at);if(ar){O(this).children().first("a").prepend(ar)}if(R){var ax=O(this).children().first("a");O.ajax({url:ax.attr("href")+"/edit",async:true,dataType:"html",success:function(az){if(-1!=az.search(h.ANT)){ax.append('<span class="wpmt_bozo_profile" >'+au+" - ANT</span>");ax.parents("tr").addClass("wpmt_bozo_post")}else{ax.append('<span class="wpmt_bozo_profile" >'+au+"</span>");ax.parents("tr").addClass("wpmt_bozo_post")}},error:function(){ax.append('<span class="wpmt_bozo_profile" >'+au+"</span>");ax.parents("tr").addClass("wpmt_bozo_post")}})}else{O(this).append('<span class="wpmt_bozo_profile" >'+au+"</span>");O(this).parents("tr").addClass("wpmt_bozo_post")}if(au.indexOf("BOZO")!==-1){++ao}}else{O(this).parent().addClass("wpmt_normal_post")}O(this).children().first("a").after(aq)}else{var aw=O(this).find("span.wpmt_bozo_profile");if(v(aw)&&(aw.text().indexOf("BOZO")!==-1)){++ao}}if(av.attr("checked")){O(this).attr("style","background: "+g+";");O(this).addClass("post_selected")}else{O(this).css("background",ay);O(this).removeClass("post_selected")}if((typeof(ap)!=="undefined")&&(ap===O(this).parent().attr("id"))){if(av.attr("checked")){O(this).css("background",ay);av.attr("checked",false);O(this).removeClass("post_selected")}else{O(this).attr("style","background: "+g+";");av.attr("checked",true);O(this).addClass("post_selected")}}});var al=O("tbody > tr").length,an=O("tbody > tr > "+G.column+":checked").length;if(an<al){O(G.bulk_actions_checkbox).attr("checked",false)}if(an===al){O(G.bulk_actions_checkbox).attr("checked",true)}var ak="";var am=(G.topics)?"topic":"post";ak+="Current Page: "+al+" "+am+((al===1)?"":"s");if(!G.topics){ak+=' &#10022; <span class="wpmt_profile_type">';ak+=(ao>0)?ao+" bozo"+((ao===1)?"":"s"):"0 bozos";ak+="</span>"}ak+=' | <span class="wpmt_profile_type wpmt_selected">';ak+=(an>0)?an+" "+am+((an===1)?"":"s")+" selected":"No "+am+"s selected";ak+="</span> | ";G.stats.append(ak)}function aa(){O(".wpmt_ip-warning").remove();var am=ai;var al={};var an={};var ak={};am=am.filter(function(){var ao=O(this).find(G.author).text();var ap=O(this).find(".post-ip-link").text();if(!(ao.length&&ap.length)){return false}if(al[ao+ap]){return false}else{al[ao+ap]=true;return true}});O.each(am,function(ao,ap){var aq=O(this).find(".post-ip-link").text();if(aq.length){if(an[aq]){ak[aq]=true}else{an[aq]=true}}});if(O.isEmptyObject(ak)){return}ai.each(function(){var ap=O(this).find(".post-ip-link");if(v(ap)===1){var ao=ap.text();if(ak[ao]){ap.before(O('<span class="wpmt_ip-warning">(DUPLICATE IP)</span>'))}}})}function F(){O("#yourtaglist").find("a").each(function(){if(O(this).text()!=="modlook"){return true}var al=O(this).parents("li");if(!v(al)){return true}parent_id=al.attr("id").split("_");if(parent_id[1].length){if(R){var ak=parent_id[1];O.ajax({url:"https://wordpress.org/support/profile/"+parent_id[1],async:true,dataType:"html",success:function(an){var am=h.username.exec(an);if(am.length>=2){ak=am[1]}al.append(O('<a class="wpmt_modlook" href="https://wordpress.org/support/profile/'+parent_id[1]+'" title="modlook tagged by user '+parent_id[1]+'">'+ak+"</a>"))}})}else{al.append(O('<a class="wpmt_modlook" href="https://wordpress.org/support/profile/'+parent_id[1]+'" title="modlook tagged by user '+parent_id[1]+'">'+parent_id[1]+"</a>"))}}})}function j(){var ao=0,ak=0,am=0;var an=O("#ed_toolbar");if(v(an)){var al=O('<input id="moderator_tools_ed_uncap" class="moderator_tools_ed_button" type="button" value="l-case" accesskey="d">');an.append(al);O("#post_content").add(O("#topic")).select(function(ap){ao=ap.target.selectionStart;ak=ap.target.selectionEnd;am=O(this)});al.bind("click.wpmt",function(at){at.preventDefault();if(am){var ar=am.val().substring(ao,ak).toLowerCase();var ap=am.val().substring(0,ao)+ar+am.val().substring(ak);am.val(ap);am.focus();var aq=am.get(0);aq.selectionStart=ak;aq.selectionEnd=ak}ao=ak=am=0})}}function ae(ak){var al=O(ak).find("a");if(!v(O(al))){return}O(al).attr("href",function(){var an=this.search;var am=this.protocol+"//"+this.host+this.pathname;var ao=false;if(an){var ap=/view=all/g;if(!ap.test(an)){ao=am+an+"&view=all"}}else{ao=am+"?view=all"}if(ao){return ao+this.hash}return this})}function E(){el=O("form");if(v(el)){el.focusin(function(){I=true}).focusout(function(){I=false})}}function x(){O(document).bind("keyup.wpmt",function(ak){if(i.hasOwnProperty(ak.which)){delete i[ak.which]}})}function o(ak){if(O(ak.which).length){i[ak.which]=true}return Object.keys(i).length}function af(al){var am=al.offset().top;var ak=65;if(c.is(":visible")){ak=c.height();ak+=30}else{if((O(al).height()+ak)>O(window).height()){ak=5}}am=am-ak;O("html, body").animate({scrollTop:am},{duration:150})}function d(){if("hide"===ad){c.hide();L.text("type m to display the menu")}else{if("show"===ad){L.text("type m to hide the menu")}else{ad="hide";c.hide();L.text("type m to display the menu")}}}function A(){if(v(ai)){ai.removeClass(e)}}function Q(ak){i={};setTimeout(function(){window.open(ak,"_blank")},200)}function k(ak){if(!v(ak)){return""}var al="";O.each(ak,function(am,an){al+=C(an)+"<br/>"});return al}function C(ak){return ak.replace(/\%(.*?)\%/g,'<span class="wpmt_shortcut">$1</span>')}function V(am){var ak="<em>[Link redacted]</em>",al={link:/<a.*?<\/a>/gi,http:/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,4}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/gi,www:/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,4}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/gi};return am.replace(al.link,ak).replace(al.http,ak).replace(al.www,ak)}function t(ak){ak=ak.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var am=new RegExp("[\\?&]"+ak+"=([^&#]*)"),al=am.exec(location.search);return al===null?"":decodeURIComponent(al[1].replace(/\+/g," "))}function v(ak){if(typeof(ak)!=="undefined"){return ak.length}return 0}function B(){var at=O("#pages").first(),ao=O(at).find("a").not(".next"),ar=ao.last(),ap=1,al=window.location.href.split(/[?#]/)[0],an=t("filter"),am=O('<div class="all-reviews_container" id="all-reviews_container"/>'),ak=O(".all-reviews").append(am);if(at.children().first().hasClass("current")){var aq=O('<button aria-controls="all-reviews_container"  aria-expanded="false" class="button reviews-toggle-all">All reviews</button>');ak.prepend(aq);aq.click(function(){if(aq.hasClass("reviews-toggle-all--visible")){am.hide();A();ai=O(".all-reviews > .review");aa();aq.text("All reviews").removeClass("reviews-toggle-all--visible").attr("aria-expanded",false)}else{if(aq.hasClass("reviews-toggle-all--toggled")){am.show();A();aa();aq.text("Fewer reviews").addClass("reviews-toggle-all--visible").attr("aria-expanded",true)}else{var au=1;aq.text("Fewer reviews").addClass("reviews-toggle-all--toggled reviews-toggle-all--visible").attr("aria-expanded",true);for(ap;ap<ar.text();ap++){var av="";if(an.length){av="?filter="+an}O.get(al+"/page/"+(ap+1)+av,function(ax){var aw=O(ax).find(".review");am.append(aw);if(au===parseInt(ar.text())-1){ai=O(".review");aa()}au++})}}}});N+='.reviews-toggle-all {margin-bottom: 2em;padding-right: 2em;position: relative;}.reviews-toggle-all:after {content: "+";position: absolute;right: 10px;top: 0;font-family: seriffont-size: 16px;}.reviews-toggle-all--visible:after {content: "-";}'}}function ac(){var al=O('<input class="ed_button" type="button" value="strip links" />'),am=O("#ed_toolbar"),ak=O("#post_content");if(!v(am)||!v(ak)){return}am.append(al);al.click(function(an){updatedContent=V(ak.val());ak.val(updatedContent)})}function q(ak){if(!v(ak)){return}var al="border: 2px solid gold; display: inline-block; margin: 5px; padding: 5px;";ak.each(function(){var ao=O(this);var an=ao.find("a").filter(function(aq){var ar=O.trim(O(this).text());if(ar==""){return true}else{if(ar.length<3){return true}}return false});if(!v(an)){return true}var am=O('<div><span class="wpmt_screen_reader_text">Hidden links, or links with less than 3 characters found in post content</span></div>');an.each(function(){var ar=O(this);var aq=a?"font-size:1.4em;":"";ar.text(ar[0].outerHTML);var at=O('<pre style="'+al+aq+'">'+ar.html()+"</pre>");am.append(at);ar.hide()});if(a){var ap=O(".row-actions",ao).parent();if(v(ap)){ap.before(am)}else{ao.append(am)}}else{ao.append(am)}})}function l(){var ak=O("<ol />"),am=G.target,al=O('<form class="mod-tools-check-ips postform" />'),an=O('<div class="mod-tools-match-summary" />');if(!v(am)){return}am.removeClass("col-1").addClass("col-3");N+=".form-row { display: block; overflow: hidden; margin-bottom: 5px;} .mod-tools-check-ips label { font-weight: 700; } .mod-tools-ip-matched { border: 2px solid gold; padding: 0 5px; } .mod-tools-ip-matched-text { background: gold; padding: 2px; }";al.append('<div class="form-row"><label for="mod-tools-check-ips">Match IPs</label></div>');al.append('<div class="form-row"><input id="mod-tools-check-ips" placeholder="IPs space separated" type="text" /></div>');al.append('<div class="form-row"><button class="button">Match</button></div>');am.append(al);an.append(al);am.append(an);al.submit(function(ar){ar.preventDefault();var ao=O(this).find("#mod-tools-check-ips").val(),at=ao.split(" "),aq=O(".post-ip-link"),ap=true;ak.remove();ak=O("<ol />");O(".mod-tools-ip-matched").removeClass("mod-tools-ip-matched");aq.each(function(aw,av){var au=O(av);if(O.inArray(au.text(),at)!==-1){var ax="mod-tools-ip-match-"+aw;ak.append('<li><a href="#'+ax+'">'+au.text()+"</a></li>");au.addClass("mod-tools-ip-matched").attr("id",ax);ap=false}});if(ap){ak.append("<li>No matches</li>")}O(this).after(ak)})}function W(){var ap=O("div.submit"),an=O(".table-form"),am=O('<button class="button mod-tools-ips-btn">Extract IPs</button>'),ao=O("<div />"),al=O('<div class="mod-tools-ips-wrapper" />'),ak=O('<ul class="mod-tools-results-list" />');am.click(function(au){au.preventDefault();var at=O(".post-ip-link"),aq=O('<h3 class="mod-tools-ips-heading">Extracted IPs</h3>'),ar=O(this);ak.remove();ak=O('<ul class="mod-tools-results-list" />');ar.removeClass("mod-tools-ips-button-pressed");at.each(function(aw,av){var ay=O(av),ax=ay.text();if(ak.find("[data-mod-tools-ip="+ax+"]").length===0){ak.append('<li data-mod-tools-ip="'+ax+'">'+ax+"</li>")}});if(al.find(".mod-tools-ips-heading").length===0){al.append(aq)}al.append(ak);ar.addClass("mod-tools-ips-button-pressed")});an.before(al);ao.append(am);ap.after(ao)}ab()});